/*!
 * lazyRetina.js v0.1.0
 *
 * Copyright 2014 Ajay Tandon
 * Released under the MIT license
 */
var lazyRetina;!function(){lazyRetina={};var a="undefined"==typeof exports?window:exports,b={tags:{retina:"data-src-2x",normal:"data-src",normalWidth:"data-src-width"},container:"body",offset:300,lazyload:!0,onImageLoad:function(){},onBeforeImageLoad:function(){},shouldFallbackToNormal:function(a){return a.offsetWidth<a.getAttribute(this.tags.normalWidth)/2}};lazyRetina.configure=function(a){null===a&&(a={});for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])},lazyRetina.isRetina=function(){var a="(-webkit-min-device-pixel-ratio: 1.5), (min--moz-device-pixel-ratio: 1.5), (-o-min-device-pixel-ratio: 3/2), (min-resolution: 1.5dppx)";return window.devicePixelRatio>1?!0:window.matchMedia&&window.matchMedia(a).matches?!0:!1};var c=function(a){var c=(window.innerHeight||document.documentElement.clientHeight)+b.offset;if(a){var d=a.getBoundingClientRect();return d.top>=-b.offset&&d.top<=c||d.bottom>=-b.offset&&d.bottom<=c}return!1},d=function(a){return"img"===a.tagName.toLowerCase()},e=function(a,c,d){var e=new Image;b.onBeforeImageLoad(a),a.removeAttribute(b.tags.retina),a.removeAttribute(b.tags.normal),e.onload=function(){a.style.visibility="visible",d(),b.onImageLoad(a)},e.src=c},f=function(a,c){var d=c&&!b.shouldFallbackToNormal(a)?b.tags.retina:b.tags.normal,e=a.getAttribute(d);return e?e:!1},g=function(a){a.removeAttribute("src"),a.style.visibility="hidden",a.style.backgroundImage=""},h=function(){for(var a,h=b.container+" ["+b.tags.normal+"]",i=document.querySelectorAll(h),j=i.length,k=lazyRetina.isRetina(),l=0;j>l;l++)!c(i[l])&&b.lazyload||null!=i[l].getAttribute("data-no-retina-lazy")||(a=f(i[l],k),g(i[l]),a&&e(i[l],a,function(a,b){d(a)?a.setAttribute("src",b):a.style.backgroundImage="url('"+b+"')"}.bind(this,i[l],a)))};lazyRetina.init=function(c){this.configure(c),h(b),a.onload=function(){h(b)},$(document).on("touchmove",function(){h(b)}),b.lazyload&&(a.onscroll=function(){h(b)})}}(this);